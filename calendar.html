<!doctype html>
<html lang="sv">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Calendar</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >
    <link rel="stylesheet" href="/assets/css/site.f3c51a6396.css">

    <style>
      .calendar-subscribe {
        position: relative;
        display: inline-block;
      }

      .calendar-subscribe-toggle {
        cursor: pointer;
      }

      .calendar-subscribe-menu {
        position: absolute;
        margin-top: 0.25rem;
        padding: 0.25rem 0;
        background: #fff;
        border: 1px solid #ccc;
        border-radius: 0.25rem;
        min-width: 220px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        display: none;
        z-index: 1000;
      }

      .calendar-subscribe-menu a {
        display: block;
        padding: 0.25rem 0.75rem;
        text-decoration: none;
        color: inherit;
        white-space: nowrap;
      }

      .calendar-subscribe-menu a:hover {
        background: #f0f0f0;
      }

      .calendar-subscribe-menu.is-open {
        display: block;
      }
    </style>
  </head>
  <body>
    <div id="include-header"></div>

    <main class="container py-4">
      <h1 data-i18n="calendar.title">Parish Calendar</h1>

      <p data-i18n="calendar.intro">Upcoming liturgies and events.</p>

      <!-- CALENDAR (three fixed iframes; we show/hide by language) -->
      <div class="mb-3">
        <!-- Swedish (default visible) -->
        <iframe
          class="gcal-frame"
          data-lang="sv"
          src="https://calendar.google.com/calendar/embed?src=serbianorthodox.malmo%40gmail.com&ctz=Europe%2FStockholm&hl=sv"
          style="width:100%; height:70vh; min-height:600px; border:0; display:block;"
          frameborder="0"
          scrolling="no"
          loading="lazy"
        ></iframe>

        <!-- English -->
        <iframe
          class="gcal-frame"
          data-lang="en"
          src="https://calendar.google.com/calendar/embed?src=serbianorthodox.malmo%40gmail.com&ctz=Europe%2FStockholm&hl=en"
          style="width:100%; height:70vh; min-height:600px; border:0; display:none;"
          frameborder="0"
          scrolling="no"
          loading="lazy"
        ></iframe>

        <!-- Serbian -->
        <iframe
          class="gcal-frame"
          data-lang="sr"
          src="https://calendar.google.com/calendar/embed?src=serbianorthodox.malmo%40gmail.com&ctz=Europe%2FStockholm&hl=sr"
          style="width:100%; height:70vh; min-height:600px; border:0; display:none;"
          frameborder="0"
          scrolling="no"
          loading="lazy"
        ></iframe>
      </div>

      <!-- SUBSCRIBE DROPDOWN (custom, no Bootstrap dependency) -->
      <div class="calendar-subscribe my-3">
        <button
          type="button"
          class="btn btn-outline-secondary calendar-subscribe-toggle"
          data-i18n="calendar.subscribe.button"
        >
          Subscribe to calendar ▾
        </button>
        <div class="calendar-subscribe-menu">
          <a
            href="https://calendar.google.com/calendar/render?cid=https://calendar.google.com/calendar/ical/serbianorthodox.malmo%40gmail.com/public/basic.ics"
            target="_blank"
            rel="noopener"
            data-i18n="calendar.subscribe.google"
          >
            Google Calendar
          </a>
          <a
            href="webcal://calendar.google.com/calendar/ical/serbianorthodox.malmo%40gmail.com/public/basic.ics"
            data-i18n="calendar.subscribe.apple"
          >
            iCalendar (iPhone / Mac)
          </a>
          <a
            href="https://outlook.live.com/calendar/0/addfromweb?url=https://calendar.google.com/calendar/ical/serbianorthodox.malmo%40gmail.com/public/basic.ics&name=Serbian%20Orthodox%20Church%20Malm%C3%B6"
            target="_blank"
            rel="noopener"
            data-i18n="calendar.subscribe.outlook"
          >
            Outlook.com
          </a>
        </div>
      </div>

      <p class="small text-muted" data-i18n="calendar.subscribe.help">
        Apple Calendar: copy the iCal link. On iPhone/iPad go to Settings → Calendar → Accounts → Add Subscribed Calendar.
      </p>
    </main>

    <div id="include-footer"></div>

    <!-- Keep this order -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/js/i18n.js"></script>
    <script src="/assets/js/include.js"></script>

    <!-- One small script to swap iframes when language changes -->
    <script>
      (function () {
        function getLang() {
          // i18n sets <html lang>; that's our source of truth
          return document.documentElement.lang || localStorage.getItem("lang") || "sv";
        }
        function showCalendar(lang) {
          document.querySelectorAll(".gcal-frame").forEach(function (f) {
            f.style.display = f.getAttribute("data-lang") === lang ? "block" : "none";
          });
        }
        // Initial
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", function () {
            showCalendar(getLang());
          });
        } else {
          showCalendar(getLang());
        }
        // React when <html lang> changes
        var mo = new MutationObserver(function () {
          showCalendar(getLang());
        });
        mo.observe(document.documentElement, { attributes: true, attributeFilter: ["lang"] });
      })();
    </script>

    <!-- Simple JS for our custom dropdown -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        var container = document.querySelector(".calendar-subscribe");
        if (!container) return;

        var toggle = container.querySelector(".calendar-subscribe-toggle");
        var menu = container.querySelector(".calendar-subscribe-menu");
        if (!toggle || !menu) return;

        toggle.addEventListener("click", function (event) {
          event.stopPropagation();
          menu.classList.toggle("is-open");
        });

        document.addEventListener("click", function (event) {
          if (!menu.contains(event.target) && event.target !== toggle) {
            menu.classList.remove("is-open");
          }
        });
      });
    </script>
  </body>
</html>
