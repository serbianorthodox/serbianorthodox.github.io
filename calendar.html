<!doctype html>
<html lang="sv">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Calendar</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>
    <div id="include-header"></div>

    <main class="container py-4">
      <h1 data-i18n="calendar.title">Parish Calendar</h1>
      <p data-i18n="calendar.intro">Upcoming liturgies and events.</p>
      <div class="mb-3">
  <div class="ratio ratio-16x9">
    <iframe
      id="gcal"
      data-base-src="https://calendar.google.com/calendar/embed?src=879f7dc660496c5013f132b95eb0f0b9e71471304b4c879338072473ceddbbc4%40group.calendar.google.com&ctz=Europe%2FStockholm"
      src="https://calendar.google.com/calendar/embed?src=879f7dc660496c5013f132b95eb0f0b9e71471304b4c879338072473ceddbbc4%40group.calendar.google.com&ctz=Europe%2FStockholm"
      style="border:0"
      frameborder="0"
      scrolling="no"
      loading="lazy">
    </iframe>
  </div>
</div>

    </main>

    <div id="include-footer"></div>

    <script src="/assets/js/i18n.js"></script>
    <script src="/assets/js/include.js"></script>
    <script>
(function () {
  function mapLangForGoogle(lang) {
    if (lang === 'sr') return 'sr';
    if (lang === 'sv') return 'sv';
    return 'en';
  }

  function updateCalendarLang() {
    var lang = document.documentElement.lang || localStorage.getItem('lang') || 'sv';
    var iframe = document.querySelector('iframe[src*="calendar.google.com/calendar/embed"]');
    if (!iframe) return;
    try {
      var url = new URL(iframe.src);
      url.searchParams.set('hl', mapLangForGoogle(lang));
      iframe.src = url.toString();
    } catch (e) {
      console.error('Could not update calendar language', e);
    }
  }

  // run now
  updateCalendarLang();

  // also run after language changes
  if (window.__setLang) {
    const originalSetLang = window.__setLang;
    window.__setLang = async function (lang) {
      await originalSetLang(lang);
      updateCalendarLang();
    };
  }
})();
</script>

  </body>
</html>
